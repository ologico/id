<!doctype html>
<html lang="en">
  <head>
    <link rel="sitemap" href="/sitemap-index.xml" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>Infinite Logic</title>
  </head>
  <body>
    <div id="logout-container" style="position: fixed; top: 10px; right: 10px; display: none;">
      <button id="logout-btn">Logout</button>
    </div>
    <slot />
    
    <script>
      import { logout, whoami } from '../util/tools.ts';
      
      // Check if user is logged in and show/hide logout button accordingly
      async function checkLoginStatus() {
        const humanId = await whoami();
        const logoutContainer = document.getElementById('logout-container');
        
        if (humanId && humanId !== 'Not logged in' && humanId !== 'Failed to get user info') {
          logoutContainer.style.display = 'block';
        } else {
          logoutContainer.style.display = 'none';
        }
      }
      
      // Check login status when page loads
      checkLoginStatus();
      
      // Handle logout button click
      document.getElementById('logout-btn')?.addEventListener('click', async () => {
        const result = await logout();
        alert(result);
        if (result.includes('successfully')) {
          window.location.href = '/';
        }
      });
    </script>
  </body>
</html>

<style is:global>
  html,
  body {
    background-color: black;
    color: #00ff00;
    font-family: monospace;
    font-size: 14pt;
  }

  a {
    color: #58a6ff;
    text-decoration: none;
  }

  a:visited {
    color: #8e96f0;
  }

  a:hover {
    color: #79c0ff;
  }

  button {
    background-color: black;
    color: #00ff00;
    font-family: monospace;
    font-size: 18pt;
    padding: 10px 20px;
    border: 2px solid #00ff00;
    cursor: pointer;
  }

  button:hover {
    background-color: #00ff00;
    color: black;
  }
</style>
